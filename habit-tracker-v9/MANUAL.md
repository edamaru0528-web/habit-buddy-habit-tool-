# ç¿’æ…£åŒ–ãƒˆãƒ©ãƒƒã‚«ãƒ¼ Ver 9.0 ä½¿ç”¨ãƒãƒ‹ãƒ¥ã‚¢ãƒ«

## ğŸ“– ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [ç®¡ç†ç”»é¢ã®ä½¿ã„æ–¹](#ç®¡ç†ç”»é¢ã®ä½¿ã„æ–¹)
4. [å­ãƒšãƒ¼ã‚¸ï¼ˆç”Ÿå¾’ç”¨ï¼‰ã®ä½¿ã„æ–¹](#å­ãƒšãƒ¼ã‚¸ç”Ÿå¾’ç”¨ã®ä½¿ã„æ–¹)
5. [ãƒ‡ãƒ¼ã‚¿æ§‹é€ ](#ãƒ‡ãƒ¼ã‚¿æ§‹é€ )
6. [è¨ˆç®—å¼ãƒ»ãƒ­ã‚¸ãƒƒã‚¯](#è¨ˆç®—å¼ãƒ­ã‚¸ãƒƒã‚¯)
7. [ä¸€æ™‚åœæ­¢æ©Ÿèƒ½ã®ä»•æ§˜](#ä¸€æ™‚åœæ­¢æ©Ÿèƒ½ã®ä»•æ§˜)
8. [ã‚¯ãƒ©ã‚¦ãƒ‰åŒæœŸã®ä»•çµ„ã¿](#ã‚¯ãƒ©ã‚¦ãƒ‰åŒæœŸã®ä»•çµ„ã¿)
9. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

ç¿’æ…£åŒ–ãƒˆãƒ©ãƒƒã‚«ãƒ¼ã¯ã€ã‚³ãƒ¼ãƒãŒè¤‡æ•°ã®ç”Ÿå¾’ã®ç¿’æ…£ã‚’ç®¡ç†ã—ã€ç”Ÿå¾’ãŒæ—¥ã€…ã®ç¿’æ…£ã‚’ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã™ã‚‹ãŸã‚ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½
- **ç®¡ç†ç”»é¢ï¼ˆadmin.htmlï¼‰**: ã‚³ãƒ¼ãƒãŒç”Ÿå¾’ã‚’è¿½åŠ ãƒ»ç®¡ç†ã—ã€å„ç”Ÿå¾’ã®é€²æ—çŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç¢ºèª
- **å­ãƒšãƒ¼ã‚¸ï¼ˆindex.htmlï¼‰**: ç”Ÿå¾’ãŒè‡ªåˆ†ã®ç¿’æ…£ã‚’è¨˜éŒ²ãƒ»è¿½è·¡

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- HTML/CSS/JavaScriptï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ä¸ä½¿ç”¨ï¼‰
- ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: JSONBin.io
- ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°: Vercel
- PWAå¯¾å¿œï¼ˆService Workerï¼‰

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      JSONBin.io (ã‚¯ãƒ©ã‚¦ãƒ‰)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ãƒã‚¹ã‚¿ãƒ¼Bin (69678ac9d0ea881f406b5bc5)                      â”‚
â”‚  â”œâ”€â”€ users: [ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¹ãƒˆ + å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®binId]               â”‚
â”‚  â””â”€â”€ baseUrl: å…¬é–‹URLè¨­å®š                                    â”‚
â”‚                                                             â”‚
â”‚  ãƒ¦ãƒ¼ã‚¶ãƒ¼å€‹åˆ¥Bin (å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«è‡ªå‹•ä½œæˆ)                     â”‚
â”‚  â”œâ”€â”€ habits: [ç¿’æ…£ãƒªã‚¹ãƒˆ]                                    â”‚
â”‚  â””â”€â”€ logs: [è¨˜éŒ²ãƒ­ã‚°ãƒªã‚¹ãƒˆ]                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç®¡ç†ç”»é¢       â”‚ â”‚   å­ãƒšãƒ¼ã‚¸A      â”‚ â”‚   å­ãƒšãƒ¼ã‚¸B      â”‚
â”‚  (admin.html)   â”‚ â”‚ (index.html     â”‚ â”‚ (index.html     â”‚
â”‚                 â”‚ â”‚  ?user=xxx)     â”‚ â”‚  ?user=yyy)     â”‚
â”‚  ã‚³ãƒ¼ãƒPC/       â”‚ â”‚                 â”‚ â”‚                 â”‚
â”‚  ã‚¹ãƒãƒ›          â”‚ â”‚  ç”Ÿå¾’Aã®ç«¯æœ«     â”‚ â”‚  ç”Ÿå¾’Bã®ç«¯æœ«     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç®¡ç†ç”»é¢ã®ä½¿ã„æ–¹

### ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•
```
https://[your-domain]/admin.html
```

### ä¸»ãªæ©Ÿèƒ½

#### 1. å…¬é–‹URLè¨­å®š
ç®¡ç†ç”»é¢ä¸Šéƒ¨ã®ã€Œå…¬é–‹URLè¨­å®šã€ã«ã€Vercelã®å…¬é–‹URLã‚’å…¥åŠ›ã—ã¦ã€Œè¨­å®šä¿å­˜ã€ã‚’æŠ¼ã™ã€‚
- ä¾‹: `https://habit-buddy-habit-tool.vercel.app/`
- ã“ã®è¨­å®šã¯ã‚¯ãƒ©ã‚¦ãƒ‰ã«ä¿å­˜ã•ã‚Œã€å…¨ã¦ã®ãƒ‡ãƒã‚¤ã‚¹ã§å…±æœ‰ã•ã‚Œã‚‹

#### 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆç”Ÿå¾’ï¼‰ã®è¿½åŠ 
1. ã€Œå­¦ç¿’è€…å...ã€å…¥åŠ›æ¬„ã«åå‰ã‚’å…¥åŠ›
2. ã€Œä½œæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ä¸€æ„ã®IDãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã€å°‚ç”¨URLãŒç™ºè¡Œã•ã‚Œã‚‹

#### 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã®ç¢ºèª
å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚«ãƒ¼ãƒ‰ã«ã¯ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼š
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼å**
- **çµŒéæ—¥æ•°**: ç¿’æ…£é–‹å§‹ã‹ã‚‰ã®æ—¥æ•°
- **ç¶™ç¶šæ—¥æ•°**: é€£ç¶šã§æ´»å‹•ãŒã‚ã£ãŸæ—¥æ•°
- **é”æˆç‡**: æœ¬æ—¥ã®ç›®æ¨™é”æˆç‡ï¼ˆãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒªãƒ³ã‚°ï¼‰

#### 4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œï¼ˆâ‹®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰
- **ãƒªãƒ³ã‚¯**: ç”Ÿå¾’ç”¨ãƒšãƒ¼ã‚¸ã®URLã‚’è¡¨ç¤º
- **QRã‚³ãƒ¼ãƒ‰**: ç”Ÿå¾’ç”¨ãƒšãƒ¼ã‚¸ã®QRã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
- **é éš”ç·¨é›†**: ç¿’æ…£ã®è¿½åŠ ãƒ»ç·¨é›†ï¼ˆã‚³ãƒ¼ãƒãŒä»£ç†ã§ç·¨é›†å¯èƒ½ï¼‰
- **å‰Šé™¤**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤

#### 5. å…¨ã¦åŒæœŸ
ã€ŒğŸ”„ å…¨ã¦åŒæœŸï¼ˆã‚¯ãƒ©ã‚¦ãƒ‰ã‹ã‚‰å–å¾—ï¼‰ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ï¼š
1. ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¦ãƒ‰ã«ãƒ—ãƒƒã‚·ãƒ¥
2. ã‚¯ãƒ©ã‚¦ãƒ‰ã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
3. ç”»é¢ã‚’æ›´æ–°

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½
- **JSONã§å…¨ä¿å­˜**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’JSONãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- **JSONã‹ã‚‰å¾©å…ƒ**: JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ
- **å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼CSV**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é€²æ—ã‚’CSVã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

---

## å­ãƒšãƒ¼ã‚¸ï¼ˆç”Ÿå¾’ç”¨ï¼‰ã®ä½¿ã„æ–¹

### ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•
```
https://[your-domain]/index.html?user=[userId]
```

### ãƒ›ãƒ¼ãƒ ç”»é¢

#### é€²è¡ŒçŠ¶æ³ãƒªãƒ³ã‚°
- ä¸­å¤®ã®å††å½¢ã‚°ãƒ©ãƒ•ã§æœ¬æ—¥ã®å…¨ä½“é€²æ—ã‚’è¡¨ç¤º
- å„ç¿’æ…£ãŒè‰²åˆ†ã‘ã•ã‚ŒãŸã‚»ã‚°ãƒ¡ãƒ³ãƒˆã§è¡¨ç¤º

#### ç¿’æ…£ã‚«ãƒ¼ãƒ‰
å„ç¿’æ…£ã‚«ãƒ¼ãƒ‰ã«ã¯ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼š
- **ç¿’æ…£å**
- **ğŸ”¥ç¶™ç¶šæ—¥æ•°**ï¼ˆé€£ç¶šæ´»å‹•æ—¥æ•°ï¼‰
- **ç¾åœ¨å€¤/ç›®æ¨™å€¤**
- **é”æˆç‡**

#### è¨˜éŒ²æ–¹æ³•

##### å›æ•°/åˆ†ã‚¿ã‚¤ãƒ—ã®ç¿’æ…£
- æ•°å€¤å…¥åŠ›æ¬„ã«ç›´æ¥å€¤ã‚’å…¥åŠ›
- å€¤ã‚’å¤‰æ›´ã™ã‚‹ã¨ã‚¯ãƒ©ã‚¦ãƒ‰ã«è‡ªå‹•åŒæœŸ

##### ãƒã‚§ãƒƒã‚¯ã‚¿ã‚¤ãƒ—ã®ç¿’æ…£
- âœ“ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—ã§ON/OFFåˆ‡ã‚Šæ›¿ãˆ
- ONã«ã™ã‚‹ã¨å€¤ãŒ1ã«ãªã‚‹

### ç¿’æ…£ã®è¿½åŠ 

#### ã‚¯ã‚¤ãƒƒã‚¯è¿½åŠ 
1. ç¿’æ…£åã‚’å…¥åŠ›
2. ã‚¿ã‚¤ãƒ—ã‚’é¸æŠï¼ˆå›æ•°/åˆ†/ãƒã‚§ãƒƒã‚¯ï¼‰
3. ç›®æ¨™å€¤ã‚’è¨­å®š
4. ã€Œè¿½åŠ ã€ãƒœã‚¿ãƒ³

#### ãƒ¢ãƒ¼ãƒ€ãƒ«ã‹ã‚‰è¿½åŠ 
1. å³ä¸‹ã®ã€Œï¼‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
2. ç¿’æ…£åã€ã‚¿ã‚¤ãƒ—ã€ã‚«ãƒ†ã‚´ãƒªãƒ¼ã€ç›®æ¨™ã‚’å…¥åŠ›
3. ã€Œè¿½åŠ ã€ãƒœã‚¿ãƒ³

### ç¿’æ…£ã®ç·¨é›†
1. ç¿’æ…£ã‚«ãƒ¼ãƒ‰ã‚’ã‚¿ãƒƒãƒ—
2. ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ä»¥ä¸‹ã‚’å¤‰æ›´å¯èƒ½ï¼š
   - é …ç›®å
   - ã‚¿ã‚¤ãƒ—
   - ç›®æ¨™å€¤
   - ã‚«ãƒ†ã‚´ãƒªãƒ¼
   - è‰²
   - é–‹å§‹æ—¥
   - **ä¸€æ™‚åœæ­¢ã®è¨­å®š**

### ä»Šæ—¥ã®æŒ¯ã‚Šè¿”ã‚Š
ãƒ›ãƒ¼ãƒ ç”»é¢ä¸‹éƒ¨ã®ãƒ†ã‚­ã‚¹ãƒˆæ¬„ã«æŒ¯ã‚Šè¿”ã‚Šã‚’å…¥åŠ›ã™ã‚‹ã¨è‡ªå‹•ä¿å­˜ã•ã‚Œã‚‹ã€‚

### ç”»é¢ã‚¿ãƒ–
- **ãƒ›ãƒ¼ãƒ **: ä»Šæ—¥ã®ç¿’æ…£ä¸€è¦§
- **å±¥æ­´**: éå»ã®è¨˜éŒ²ã‚’ãƒ•ã‚©ãƒ«ãƒ€å½¢å¼ã§é–²è¦§
- **æœˆé–“**: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ“ãƒ¥ãƒ¼ã§æœˆé–“ã®é”æˆçŠ¶æ³ã‚’ç¢ºèª
- **åˆ†æ**: æ›œæ—¥åˆ¥ãƒ»é …ç›®åˆ¥ã®é”æˆç‡ã‚°ãƒ©ãƒ•

---

## ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### ãƒã‚¹ã‚¿ãƒ¼ãƒ“ãƒ³ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¹ãƒˆï¼‰

```json
{
  "users": [
    {
      "id": "abc123",           // ä¸€æ„ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
      "name": "å±±ç”°å¤ªéƒ",        // ãƒ¦ãƒ¼ã‚¶ãƒ¼å
      "startDate": "2026-01-01", // ç™»éŒ²æ—¥
      "binId": "xyz789"         // å€‹åˆ¥ãƒ‡ãƒ¼ã‚¿ä¿å­˜å…ˆã®Bin ID
    }
  ],
  "baseUrl": "https://example.vercel.app/"
}
```

### ãƒ¦ãƒ¼ã‚¶ãƒ¼å€‹åˆ¥ãƒ‡ãƒ¼ã‚¿

```json
{
  "habits": [
    {
      "id": "habit123",          // ç¿’æ…£ã®ä¸€æ„ID
      "name": "æœã®èª­æ›¸",         // ç¿’æ…£å
      "type": "minutes",         // ã‚¿ã‚¤ãƒ—: "count" | "minutes" | "check"
      "goal": 30,                // ç¾åœ¨ã®ç›®æ¨™å€¤
      "category": "å­¦ç¿’",        // ã‚«ãƒ†ã‚´ãƒªãƒ¼
      "color": "#00B4B4",        // è¡¨ç¤ºè‰²ï¼ˆ16é€²æ•°ï¼‰
      "startDate": "2026-01-01", // é–‹å§‹æ—¥
      "isPaused": false,         // ä¸€æ™‚åœæ­¢ä¸­ã‹ã©ã†ã‹
      "pausedDate": null,        // ä¸€æ™‚åœæ­¢ã—ãŸæ—¥ä»˜ï¼ˆåœæ­¢ä¸­ã®ã¿ï¼‰
      "goalHistory": [           // ç›®æ¨™å¤‰æ›´å±¥æ­´
        { "date": "2026-01-01", "value": 20 },
        { "date": "2026-01-10", "value": 30 }
      ]
    }
  ],
  "logs": [
    {
      "habit": "æœã®èª­æ›¸",         // ç¿’æ…£åï¼ˆç¿’æ…£åã§ç´ä»˜ã‘ï¼‰
      "value": 25,               // è¨˜éŒ²ã—ãŸå€¤
      "timestamp": "2026-01-15T08:30:00.000Z" // è¨˜éŒ²æ—¥æ™‚ï¼ˆISOå½¢å¼ï¼‰
    }
  ],
  "reflections": {
    "2026-01-15": "ä»Šæ—¥ã¯é›†ä¸­ã§ããŸï¼"
  },
  "lastConfettiDate": "2026-01-15"  // æœ€å¾Œã«ç´™å¹é›ªã‚’è¡¨ç¤ºã—ãŸæ—¥
}
```

---

## è¨ˆç®—å¼ãƒ»ãƒ­ã‚¸ãƒƒã‚¯

### 1. é”æˆç‡ï¼ˆ1æ—¥ï¼‰

```javascript
function getDailyProgress(data, dateKey) {
    // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªç¿’æ…£ã®ã¿å¯¾è±¡
    const activeHabits = data.habits.filter(h => {
        if (h.startDate > dateKey) return false;  // ã¾ã é–‹å§‹ã—ã¦ã„ãªã„
        if (h.isPaused && h.pausedDate && h.pausedDate <= dateKey) return false;  // åœæ­¢æ—¥ä»¥é™
        return true;
    });
    
    if (activeHabits.length === 0) return 0;
    
    // å„ç¿’æ…£ã®é”æˆç‡ã‚’åˆè¨ˆ
    const totalPct = activeHabits.reduce((sum, h) => {
        const status = getHabitStatusAtDate(h, data.logs, dateKey);
        return sum + status.pct;  // pct = min(1, current / goal)
    }, 0);
    
    // å¹³å‡ã‚’%ã§è¿”ã™
    return Math.floor((totalPct / activeHabits.length) * 100);
}
```

**è¨ˆç®—å¼:**
```
é”æˆç‡(%) = Î£(å„ç¿’æ…£ã® min(ç¾åœ¨å€¤/ç›®æ¨™å€¤, 1)) / ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ç¿’æ…£æ•° Ã— 100
```

### 2. ç¿’æ…£ã”ã¨ã®é”æˆçŠ¶æ³

```javascript
function getHabitStatusAtDate(habit, logs, dateKey) {
    // ãã®æ—¥ã®ãƒ­ã‚°ã‚’æŠ½å‡º
    const dayLogs = logs.filter(l => 
        l.habit === habit.name && 
        l.timestamp.split('T')[0] === dateKey
    );
    
    // ç¾åœ¨å€¤ = ãƒ­ã‚°ã®å€¤ã®åˆè¨ˆ
    const current = dayLogs.reduce((sum, l) => sum + (l.value || 1), 0);
    
    // ãã®æ—¥ã®ç›®æ¨™å€¤ã‚’å–å¾—ï¼ˆå±¥æ­´ã‹ã‚‰ï¼‰
    const goal = getGoalAtDate(habit, dateKey);
    
    return {
        current,                           // ç¾åœ¨å€¤
        goal,                              // ç›®æ¨™å€¤
        isAchieved: current >= goal,       // é”æˆã—ãŸã‹
        hasActivity: current >= 1,         // 1ä»¥ä¸Šã®æ´»å‹•ãŒã‚ã£ãŸã‹
        pct: Math.min(1, current / goal)   // é”æˆç‡ï¼ˆ0ã€œ1ï¼‰
    };
}
```

### 3. ç¶™ç¶šæ—¥æ•°ï¼ˆã‚¹ãƒˆãƒªãƒ¼ã‚¯ï¼‰

```javascript
function calculateStreak(habit, logs) {
    let streak = 0;
    let checkDate = new Date();
    const todayKey = getDateKey(checkDate);
    const todayStatus = getHabitStatusAtDate(habit, logs, todayKey);

    // ä»Šæ—¥æ´»å‹•ãŒãªã‘ã‚Œã°æ˜¨æ—¥ã‹ã‚‰é–‹å§‹
    if (!todayStatus.hasActivity) {
        checkDate.setDate(checkDate.getDate() - 1);
    }

    // éå»ã«é¡ã£ã¦é€£ç¶šæ´»å‹•æ—¥ã‚’æ•°ãˆã‚‹
    while (true) {
        const key = getDateKey(checkDate);
        if (key < habit.startDate) break;  // é–‹å§‹æ—¥ã‚ˆã‚Šå‰ã¯ç„¡è¦–
        
        const status = getHabitStatusAtDate(habit, logs, key);
        if (status.hasActivity) {  // 1ä»¥ä¸Šã®æ´»å‹•ãŒã‚ã‚Œã°ã‚«ã‚¦ãƒ³ãƒˆ
            streak++;
            checkDate.setDate(checkDate.getDate() - 1);
        } else {
            break;  // æ´»å‹•ãŒãªã‘ã‚Œã°çµ‚äº†
        }
    }
    return streak;
}
```

**ã‚¹ãƒˆãƒªãƒ¼ã‚¯ã®ãƒ«ãƒ¼ãƒ«:**
- æ´»å‹•åˆ¤å®š: `current >= 1`ï¼ˆç›®æ¨™é”æˆã§ã¯ãªãã€1ä»¥ä¸Šã®è¨˜éŒ²ãŒã‚ã‚Œã°OKï¼‰
- ä»Šæ—¥è¨˜éŒ²ãŒãªãã¦ã‚‚ã€æ˜¨æ—¥ã¾ã§ã®é€£ç¶šã¯ç¶­æŒã•ã‚Œã‚‹
- é–‹å§‹æ—¥ã‚ˆã‚Šå‰ã¯è¨ˆç®—å¯¾è±¡å¤–

### 4. ç›®æ¨™å€¤ã®å±¥æ­´å¯¾å¿œ

```javascript
function getGoalAtDate(habit, dateKey) {
    const history = [...habit.goalHistory].sort((a, b) => 
        new Date(a.date) - new Date(b.date)
    );
    
    // dateKeyä»¥å‰ã§æœ€ã‚‚æ–°ã—ã„ç›®æ¨™ã‚’æ¢ã™
    let activeGoal = history[0].value;
    for (const entry of history) {
        if (entry.date <= dateKey) {
            activeGoal = entry.value;
        } else {
            break;
        }
    }
    return activeGoal;
}
```

**ä¾‹:**
- 1/1: ç›®æ¨™20ã«è¨­å®š
- 1/10: ç›®æ¨™30ã«å¤‰æ›´
- 1/5æ™‚ç‚¹ã®é”æˆç‡è¨ˆç®— â†’ ç›®æ¨™20ã§è¨ˆç®—
- 1/15æ™‚ç‚¹ã®é”æˆç‡è¨ˆç®— â†’ ç›®æ¨™30ã§è¨ˆç®—

### 5. ç¶™ç¶šæ—¥æ•°ã®è‰²åˆ†ã‘

```javascript
function getStreakColor(streak) {
    if (streak <= 3) return '#fcd34d';   // è–„ã„ã‚ªãƒ¬ãƒ³ã‚¸/ã‚¤ã‚¨ãƒ­ãƒ¼
    if (streak <= 7) return '#f59e0b';   // ã‚ªãƒ¬ãƒ³ã‚¸
    if (streak <= 14) return '#ea580c';  // æ¿ƒã„ã‚ªãƒ¬ãƒ³ã‚¸
    if (streak <= 30) return '#dc2626';  // ãƒ¬ãƒƒãƒ‰ã‚ªãƒ¬ãƒ³ã‚¸
    return '#b91c1c';                    // æ·±ã„èµ¤
}
```

---

## ä¸€æ™‚åœæ­¢æ©Ÿèƒ½ã®ä»•æ§˜

### æ¦‚è¦
ç¿’æ…£ã‚’ä¸€æ™‚çš„ã«è¨˜éŒ²å¯¾è±¡ã‹ã‚‰å¤–ã™æ©Ÿèƒ½ã€‚æ—…è¡Œä¸­ã‚„ä½“èª¿ä¸è‰¯æ™‚ãªã©ã«ä½¿ç”¨ã€‚

### ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

```json
{
    "isPaused": true,           // åœæ­¢ä¸­ãƒ•ãƒ©ã‚°
    "pausedDate": "2026-01-15"  // åœæ­¢ã—ãŸæ—¥ä»˜
}
```

### åœæ­¢æ™‚ã®å‡¦ç†

```javascript
// åœæ­¢ã™ã‚‹å ´åˆ
habit.isPaused = true;
habit.pausedDate = getDateKey();  // ä»Šæ—¥ã®æ—¥ä»˜ã‚’è¨˜éŒ²
```

### å†é–‹æ™‚ã®å‡¦ç†

```javascript
// å†é–‹ã™ã‚‹å ´åˆ
habit.isPaused = false;
delete habit.pausedDate;  // åœæ­¢æ—¥ã‚’å‰Šé™¤
```

### é”æˆç‡è¨ˆç®—ã¸ã®å½±éŸ¿

```javascript
const activeHabits = data.habits.filter(h => {
    if (h.startDate > dateKey) return false;  // æœªé–‹å§‹
    if (h.isPaused && h.pausedDate && h.pausedDate <= dateKey) return false;  // åœæ­¢æ—¥ä»¥é™ã¯é™¤å¤–
    return true;
});
```

**ãƒ«ãƒ¼ãƒ«:**
- `isPaused = true` ã‹ã¤ `pausedDate <= å¯¾è±¡æ—¥` â†’ è¨ˆç®—å¯¾è±¡å¤–
- åœæ­¢æ—¥ã‚ˆã‚Šå‰ã®è¨˜éŒ²ã¯é”æˆç‡ã«å«ã¾ã‚Œã‚‹
- å†é–‹å¾Œã¯é€šå¸¸é€šã‚Šè¨ˆç®—å¯¾è±¡

### UIè¡¨ç¤º
- åœæ­¢ä¸­ã®ç¿’æ…£ã¯ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆè¡¨ç¤º
- ã€Œè¨˜éŒ²åœæ­¢ä¸­ã€ã¨è¡¨ç¤º
- ã€Œå†é–‹ã€ãƒœã‚¿ãƒ³ã§ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—å†é–‹å¯èƒ½

---

## ã‚¯ãƒ©ã‚¦ãƒ‰åŒæœŸã®ä»•çµ„ã¿

### JSONBin.io APIè¨­å®š

```javascript
const JSONBIN_MASTER_KEY = '$2a$10$9gCdL3y87QxebgxH9Ea1eOT93VPPLvVcj/czCK0PaWCL3WLhOutcC';
const JSONBIN_API = 'https://api.jsonbin.io/v3/b';
const USERS_BIN_ID = '69678ac9d0ea881f406b5bc5';  // ãƒã‚¹ã‚¿ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¹ãƒˆ
```

### åŒæœŸãƒ•ãƒ­ãƒ¼ï¼ˆç®¡ç†ç”»é¢ï¼‰

```
1. ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿
    â”‚
    â–¼
2. fetchAllDataFromCloud()
    â”œâ”€â”€ ãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆå–å¾—
    â”œâ”€â”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¹ãƒˆã‚’localStorageã«ä¿å­˜
    â””â”€â”€ å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®binIdã‚’localStorageã«ä¿å­˜
    â”‚
    â–¼
3. repairMissingBinIds()
    â””â”€â”€ binIdãŒãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯æ–°è¦Binä½œæˆ
    â”‚
    â–¼
4. pushAllLocalDataToCloud()
    â””â”€â”€ ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¦ãƒ‰ã«ãƒ—ãƒƒã‚·ãƒ¥
    â”‚
    â–¼
5. fetchAllUsersDataFromCloud()
    â””â”€â”€ å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¦ãƒ‰ã‹ã‚‰å–å¾—
    â”‚
    â–¼
6. renderUsers()
    â””â”€â”€ ç”»é¢ã«è¡¨ç¤º
```

### åŒæœŸãƒ•ãƒ­ãƒ¼ï¼ˆå­ãƒšãƒ¼ã‚¸ï¼‰

```
1. ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿
    â”‚
    â–¼
2. setupUI()
    â”œâ”€â”€ ãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
    â””â”€â”€ binIdã‚’localStorageã«ä¿å­˜
    â”‚
    â–¼
3. fetchFromCloud()
    â””â”€â”€ ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¦ãƒ‰ã‹ã‚‰å–å¾—
    â”‚
    â–¼
4. renderHabits()
    â””â”€â”€ ç”»é¢ã«è¡¨ç¤º

--- è¨˜éŒ²æ™‚ ---

5. saveData(data)
    â”œâ”€â”€ localStorageã«ä¿å­˜
    â””â”€â”€ syncToCloud(data)
        â””â”€â”€ ã‚¯ãƒ©ã‚¦ãƒ‰ã«ãƒ—ãƒƒã‚·ãƒ¥
```

### localStorage ã‚­ãƒ¼ä¸€è¦§

| ã‚­ãƒ¼ | å†…å®¹ |
|------|------|
| `habitTracker_users` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¹ãƒˆ |
| `habitTracker_baseUrl` | å…¬é–‹URLè¨­å®š |
| `habitTracker_binId_{userId}` | å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®Bin ID |
| `habitTracker_{userId}` | å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç¿’æ…£ãƒ»ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ |

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ: ãƒ‡ãƒ¼ã‚¿ãŒåŒæœŸã•ã‚Œãªã„
**åŸå› **: binIdãŒãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆã«ç™»éŒ²ã•ã‚Œã¦ã„ãªã„
**è§£æ±º**: ç®¡ç†ç”»é¢ã‚’é–‹ãã¨è‡ªå‹•çš„ã«ä¿®å¾©ã•ã‚Œã‚‹

### å•é¡Œ: åˆ¥ã®ãƒ‡ãƒã‚¤ã‚¹ã§ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„
**åŸå› **: å…ƒã®ãƒ‡ãƒã‚¤ã‚¹ã§ã‚¯ãƒ©ã‚¦ãƒ‰ã«åŒæœŸã•ã‚Œã¦ã„ãªã„
**è§£æ±º**: 
1. å…ƒã®ãƒ‡ãƒã‚¤ã‚¹ã§ç®¡ç†ç”»é¢ã‚’é–‹ã
2. ã€Œå…¨ã¦åŒæœŸã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™

### å•é¡Œ: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ0%ã¨è¡¨ç¤ºã•ã‚Œã‚‹
**åŸå› **: ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®binIdãŒlocalStorageã«ä¿å­˜ã•ã‚Œã¦ã„ãªã„
**è§£æ±º**: ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨è‡ªå‹•çš„ã«ãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆã‹ã‚‰binIdã‚’å–å¾—

### å•é¡Œ: LINEã‹ã‚‰ã€Œãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã€ã§ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã‚‹
**åŸå› **: ä»¥å‰ã¯binIdãŒãƒ‡ãƒã‚¤ã‚¹é–“ã§å…±æœ‰ã•ã‚Œã¦ã„ãªã‹ã£ãŸ
**è§£æ±º**: ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ä¿®æ­£æ¸ˆã¿ã€‚ãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆã‹ã‚‰binIdã‚’å–å¾—ã™ã‚‹ãŸã‚ã€ã©ã®ãƒ‡ãƒã‚¤ã‚¹ã§ã‚‚åŒã˜ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

### ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã§ç¢ºèªã™ã¹ããƒ¡ãƒƒã‚»ãƒ¼ã‚¸

| ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | æ„å‘³ |
|-----------|------|
| `All data fetched from cloud` | ãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆå–å¾—æˆåŠŸ |
| `All users data fetched from cloud` | å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ |
| `Got Bin ID from master: xxx` | ãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆã‹ã‚‰binIdå–å¾—æˆåŠŸ |
| `Data synced to cloud` | ã‚¯ãƒ©ã‚¦ãƒ‰ã¸ã®ãƒ—ãƒƒã‚·ãƒ¥æˆåŠŸ |
| `Auto-pushing local data to cloud: ãƒ¦ãƒ¼ã‚¶ãƒ¼å` | ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•ãƒ—ãƒƒã‚·ãƒ¥ |

---

## æ›´æ–°å±¥æ­´

- **Ver 9.0**: ã‚¯ãƒ­ã‚¹ãƒ–ãƒ©ã‚¦ã‚¶åŒæœŸæ©Ÿèƒ½å®Ÿè£…ï¼ˆbinIdã®ãƒã‚¹ã‚¿ãƒ¼ãƒªã‚¹ãƒˆç®¡ç†ï¼‰
- **Ver 8.0**: ç›®æ¨™å±¥æ­´æ©Ÿèƒ½ã€ä¸€æ™‚åœæ­¢æ©Ÿèƒ½è¿½åŠ 
- **Ver 7.0**: JSONBin.ioã¸ã®ã‚¯ãƒ©ã‚¦ãƒ‰ç§»è¡Œ
